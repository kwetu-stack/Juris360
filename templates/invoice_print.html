{% extends "base.html" %}
{% block content %}
<div class="card" id="printArea">
  <div style="display:flex;justify-content:space-between;align-items:flex-start">
    <div>
      <h1 style="margin:0">Invoice {{ inv.number }}</h1>
      <div class="small">Status: {{ inv.status.name }}</div>
    </div>
    <div class="small" style="text-align:right">
      <div><strong>Client:</strong> {{ inv.client.name }}</div>
      <div><strong>Case:</strong> {{ inv.case.ref }} — {{ inv.case.title }}</div>
      <div><strong>Due:</strong> {{ inv.due_date.strftime('%Y-%m-%d') if inv.due_date else '—' }}</div>
      <div><strong>Amount:</strong> {{ '%.2f'|format(inv.amount or 0) }}</div>
      <div><strong>Paid:</strong> {{ '%.2f'|format(paid or 0) }}</div>
      <div><strong>Balance:</strong> {{ '%.2f'|format(balance or 0) }}</div>
    </div>
  </div>

  {% if payments %}
  <h3 style="margin-top:18px">Payments</h3>
  <table>
    <thead><tr><th>Date</th><th>Method</th><th>Reference</th><th style="text-align:right">Amount</th></tr></thead>
    <tbody>
      {% for p in payments %}
      <tr>
        <td>{{ p.date.strftime('%Y-%m-%d') }}</td>
        <td>{{ p.method or '' }}</td>
        <td>{{ p.reference or '' }}</td>
        <td style="text-align:right">{{ '%.2f'|format(p.amount) }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
  {% endif %}
</div>

<div class="no-print" style="margin-top:12px;display:flex;gap:10px">
  <a class="btn" onclick="window.print()">Print</a>
  <a class="btn ghost" href="{{ url_for('invoice_pdf', id=inv.id) }}">Download PDF</a>
  <a class="btn ghost" href="{{ url_for('invoices') }}">Back</a>
</div>

<style>
  @media print { .no-print, nav { display:none !important; } body { background:white } }
</style>
{% endblock %}
