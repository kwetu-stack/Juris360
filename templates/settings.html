<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Settings | Juris360</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
  <style>
    :root { --bg:#0f172a; --panel:#111827; --muted:#94a3b8; --brand:#22c55e; --accent:#38bdf8; }
    body{margin:0;font-family:system-ui,Segoe UI,Roboto,Inter,Arial,sans-serif;background:linear-gradient(180deg,#0b1220,#0f172a);color:#e5e7eb}
    a{text-decoration:none;color:inherit}
    .wrap{max-width:1100px;margin:0 auto;padding:16px}
    .nav{position:sticky;top:0;background:rgba(15,23,42,.8);backdrop-filter:blur(8px);border-bottom:1px solid #1f2937;z-index:50}
    .nav-inner{display:flex;align-items:center;justify-content:space-between;padding:10px 16px}
    .brand{display:flex;align-items:center;gap:10px;font-weight:700}
    .badge{font-size:12px;padding:2px 8px;border:1px solid #2dd4bf;border-radius:999px;color:#67e8f9}
    .menu{display:flex;gap:12px;flex-wrap:wrap}
    .menu a{padding:8px 10px;border-radius:10px;color:#cbd5e1}
    .menu a.active,.menu a:hover{background:#0b2a1e;color:#d1fae5;border:1px solid #14532d}
    .hamb{display:none}
    @media(max-width:640px){
      .menu{display:none;flex-direction:column;background:#0b1220;position:absolute;left:0;right:0;top:56px;padding:10px;border-bottom:1px solid #1f2937}
      .hamb{display:block}
      input#nav-toggle:checked ~ .menu{display:flex}
    }

    .header{display:flex;justify-content:space-between;align-items:center;margin-bottom:14px;gap:10px;flex-wrap:wrap}
    .muted{color:var(--muted)}
    .grid{display:grid;grid-template-columns:repeat(12,1fr);gap:12px}
    .card{background:linear-gradient(180deg,#0b1020,#0c1327);border:1px solid #1f2a44;border-radius:16px;padding:16px}
    .section{grid-column:span 12}
    .section.half{grid-column:span 6}
    .title{display:flex;justify-content:space-between;align-items:center;margin-bottom:10px}
    .btn{padding:8px 12px;border-radius:10px;border:1px solid #1e293b;background:#0b1220;color:#e5e7eb;cursor:pointer}
    .btn.brand{border:1px solid #14532d;background:#0b2a1e;color:#d1fae5}
    form{display:grid;grid-template-columns:repeat(2,1fr);gap:12px}
    label{font-size:13px;color:#cbd5e1}
    input,select,textarea{padding:10px;background:#0b1220;border:1px solid #1e293b;border-radius:10px;color:#e5e7eb}
    textarea{min-height:90px;resize:vertical}
    .full{grid-column:1 / -1}

    /* toggles */
    .toggle{display:flex;align-items:center;gap:10px}
    .toggle input{width:46px;height:24px}

    /* messages */
    .messages{margin:10px 0}
    .message{padding:10px;border:1px solid #1f2a44;border-radius:10px}
    .message.success{border-color:#14532d;color:#bbf7d0;background:#0b2a1e}
    .message.error{border-color:#7f1d1d;color:#fecaca;background:#3f1d1d}

    @media(max-width:980px){
      .section.half{grid-column:span 12}
      form{grid-template-columns:1fr}
    }
  </style>
</head>
<body>

<!-- Navbar -->
<nav class="nav">
  <div class="nav-inner wrap">
    <div class="brand">
      <svg width="26" height="26" viewBox="0 0 24 24" fill="none">
        <circle cx="12" cy="12" r="10" stroke="#22c55e" stroke-width="1.5"/>
        <path d="M7 12h10M12 7v10" stroke="#38bdf8" stroke-width="1.5" stroke-linecap="round"/>
      </svg>
      <span>Juris360</span>
      <span class="badge">Settings</span>
    </div>
    <label class="hamb">
      <input id="nav-toggle" type="checkbox" hidden>
      <span class="btn">☰ Menu</span>
    </label>
    <div class="menu">
      <a href="{{ url_for('dashboard') }}">Dashboard</a>
      <a href="{{ url_for('view_cases') }}">Cases</a>
      <a href="{{ url_for('view_clients') }}">Clients</a>
      <a href="{{ url_for('schedule') }}">Schedule</a>
      <a href="{{ url_for('billing') }}">Billing</a>
      <a href="{{ url_for('documents') }}">Documents</a>
      <a href="{{ url_for('reports') }}">Reports</a>
      <a href="{{ url_for('settings') }}" class="active">Settings</a>
      <a href="{{ url_for('login') }}">Logout</a>
    </div>
  </div>
</nav>

<main class="wrap" style="padding-top:18px">
  <div class="header">
    <div>
      <h1 style="margin:0">Settings</h1>
      <div class="muted">Manage firm details, preferences, and account security.</div>
    </div>
    <div>
      <a class="btn" href="{{ url_for('dashboard') }}">← Back to Dashboard</a>
    </div>
  </div>

  <!-- Flash messages -->
  <div class="messages">
    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        {% for category, message in messages %}
          <div class="message {{ category }}">{{ message }}</div>
        {% endfor %}
      {% endif %}
    {% endwith %}
  </div>

  <section class="grid">
    <!-- Firm Profile -->
    <div class="section half">
      <div class="card">
        <div class="title">
          <h3 style="margin:0">Firm Profile</h3>
        </div>
        <form action="{{ url_for('update_settings') }}" method="POST" enctype="multipart/form-data" autocomplete="on">
          <input type="hidden" name="section" value="firm_profile">
          <div>
            <label>Firm Name</label>
            <input name="firm_name" type="text" placeholder="e.g., Juris360 Advocates" required>
          </div>
          <div>
            <label>Primary Email</label>
            <input name="firm_email" type="email" placeholder="info@firm.co.ke">
          </div>
          <div>
            <label>Phone</label>
            <input name="firm_phone" type="tel" placeholder="+254 7xx xxx xxx">
          </div>
          <div>
            <label>Currency</label>
            <select name="currency">
              <option value="KES" selected>KES — Kenyan Shilling</option>
              <option value="USD">USD — US Dollar</option>
              <option value="EUR">EUR — Euro</option>
            </select>
          </div>
          <div class="full">
            <label>Address</label>
            <input name="firm_address" type="text" placeholder="Street, Building, City / P.O. Box">
          </div>
          <div class="full">
            <label>Invoice Footer Message</label>
            <textarea name="invoice_footer" placeholder="Thank you for your business!"></textarea>
          </div>
          <div class="full" style="display:flex;gap:10px;align-items:center">
            <div>
              <label>Logo (PNG/JPG)</label>
              <input name="logo" type="file" accept=".png,.jpg,.jpeg">
            </div>
            <div class="muted">Max 1MB • Shown on invoices and header</div>
          </div>
          <div class="full" style="display:flex;justify-content:flex-end;gap:8px">
            <button class="btn" type="reset">Reset</button>
            <button class="btn brand" type="submit">Save Profile</button>
          </div>
        </form>
      </div>
    </div>

    <!-- Preferences & Defaults -->
    <div class="section half">
      <div class="card">
        <div class="title">
          <h3 style="margin:0">Preferences & Defaults</h3>
        </div>
        <form action="{{ url_for('update_settings') }}" method="POST" autocomplete="on">
          <input type="hidden" name="section" value="preferences">
          <div>
            <label>Default Billing Rate (KES/hr)</label>
            <input name="default_rate" type="number" step="0.01" placeholder="e.g., 5000">
          </div>
          <div>
            <label>VAT / Tax (%)</label>
            <input name="tax_rate" type="number" step="0.01" placeholder="e.g., 16">
          </div>
          <div>
            <label>Date Format</label>
            <select name="date_format">
              <option value="YYYY-MM-DD">YYYY-MM-DD</option>
              <option value="DD/MM/YYYY">DD/MM/YYYY</option>
              <option value="MM/DD/YYYY">MM/DD/YYYY</option>
            </select>
          </div>
          <div>
            <label>Time Zone</label>
            <select name="timezone">
              <option value="Africa/Nairobi" selected>Africa/Nairobi (GMT+3)</option>
              <option value="UTC">UTC</option>
              <option value="Africa/Kampala">Africa/Kampala</option>
            </select>
          </div>
          <div class="full toggle">
            <input type="checkbox" name="enable_pdf_logo" id="enable_pdf_logo" checked>
            <label for="enable_pdf_logo">Show logo on invoices/PDFs</label>
          </div>
          <div class="full" style="display:flex;justify-content:flex-end;gap:8px">
            <button class="btn" type="reset">Reset</button>
            <button class="btn brand" type="submit">Save Preferences</button>
          </div>
        </form>
      </div>
    </div>

    <!-- Notifications -->
    <div class="section half">
      <div class="card">
        <div class="title">
          <h3 style="margin:0">Notifications</h3>
        </div>
        <form action="{{ url_for('update_settings') }}" method="POST">
          <input type="hidden" name="section" value="notifications">
          <div class="full toggle">
            <input type="checkbox" name="notify_hearings" id="notify_hearings" checked>
            <label for="notify_hearings">Email me before hearings</label>
          </div>
          <div class="full toggle">
            <input type="checkbox" name="notify_invoices" id="notify_invoices" checked>
            <label for="notify_invoices">Email me on invoice due/overdue</label>
          </div>
          <div class="full toggle">
            <input type="checkbox" name="notify_new_client" id="notify_new_client">
            <label for="notify_new_client">Notify on new client sign-up</label>
          </div>
          <div class="full" style="display:flex;justify-content:flex-end;gap:8px">
            <button class="btn" type="reset">Reset</button>
            <button class="btn brand" type="submit">Save Notifications</button>
          </div>
        </form>
      </div>
    </div>

    <!-- Change Password -->
    <div class="section half">
      <div class="card">
        <div class="title">
          <h3 style="margin:0">Change Password</h3>
        </div>
        <form action="{{ url_for('change_password') }}" method="POST" autocomplete="on">
          <div>
            <label>Current Password</label>
            <input name="current_password" type="password" required>
          </div>
          <div>
            <label>New Password</label>
            <input name="new_password" type="password" minlength="6" required>
          </div>
          <div>
            <label>Confirm New Password</label>
            <input name="confirm_password" type="password" minlength="6" required>
          </div>
          <div class="full" style="display:flex;justify-content:flex-end;gap:8px">
            <button class="btn" type="reset">Cancel</button>
            <button class="btn brand" type="submit">Update Password</button>
          </div>
        </form>
      </div>
    </div>
  </section>

  <div class="footer">Powered by Kwetu Partners Ltd · Juris360 Boilerplate</div>
</main>

</body>
</html>
